---

layout: post
title: '[Spring]Stomp + SocketJS'
subtitle: '[Spring]Stomp + SocketJS'
categories: devlog
tags: stomp
comments: true

---

# 메시징 시스템
분리된 어플리케이션간 비동기적으로 신뢰성있게 통신

특징
- 메시지 생산자(producer),소비자(consumer)간 약한 결합성
- 동적이고 신뢰성있고 유연함
- 높은 확장성, 서로 다른 네트웤 사이의 쉬운 통합, 안정성

종류
1. Public-Subcribe 방식(Pub-Sub)  
    - 생산자가 토픽에 메시지를 보내면, 해당 토픽을 구독해놓은 모든 사용자들에게 메시지가 전송되는 방식

2. Point-To-Point 방식(PTP)
    - 큐를 통해서 메시지를 전달하고 튜를 통해서 메시지를 받는 방식
    모든 사람이 큐를 하나씩 가지고 보내는 사람이 목적지 큐를정해서 전송

# stomp


프레임 구조
```
COMMAND
header1 : value1
header2 : value2

Body^@
```

## client
메세지를 보내기 위한 명령
subscritbe,send
- console.log 예시
    ```
    >>> SUBSCRIBE
    id: sub-0
    destination:/topic/users
    ```
- 사용하려면 destination이라는 헤더 필요  
    - destination   
        - 어디에 메시지 전송할지, 어디에서 메세지 구독하는지 알려주는 헤더
        - 값은 서버에서 정하는 규칙에 따라 어떤 문자열이든 가능
        - 라우팅 방향을 결정하는 prefix(일반적으로 쓰이는 destination 값)
            1. 서버측 annotated method방향
                - `/app/.../...`
            2. 브로커 방향
                - `/topic/.../...` 주소는 pub-sub 방식의 one to many일 때 사용  
                - `/queue/.../...` 주소는 point to point 방식의 one to one일 때 사용
            
    
